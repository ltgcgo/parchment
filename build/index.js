"use strict";(()=>{var h=function(e,t="&",r="="){let l=new Map;return e.length&&e.slice(1).split(t).forEach(p=>{let o=decodeURIComponent(p),c=o.indexOf(r);c>=0?l.set(o.slice(0,c),o.slice(c+r.length)):l.set(o,null)}),l};var f,u=new Worker("./worker.js"),y=h(location.search),i,D=new DOMParser,d=new Map,n,m,b=function(e){return d.has(e)?!0:(u.postMessage({id:e}),!1)};var g=async function(){for(;i.children.length>0;)n?n.body.appendChild(i.children[0]):i.removeChild(i.children[0]);a();let e=n.body.children.length,t=0;for(let r=0;r<e;r++)n.body.children[t].tagName=="H1"&&!t?t++:i.appendChild(n.body.children[t])},w=async function(e){e.length||(e="index"),e.toLowerCase().indexOf(".md")<0&&(e+=".md"),b(e)?(n=d.get(e),g()):m=e};u.addEventListener("message",e=>{let t=e.data;if(t.ok){let r=D.parseFromString(t.data,"text/html");d.set(t.id,r),m==t.id&&(n=r,g())}else m==t.id});self.parsedDoms=d;var s=document;var a=async function(){n?(self.currentDom=n,s.title=`${n.querySelector("h1")?.innerText||"Untitled"} - ${f?.site?.name||"Parchment"}`):s.title=`Loading - ${f?.site?.name||"Parchment"}`};s.addEventListener("readystatechange",function(){switch(this.readyState){case"interactive":{i=s.querySelector("main.container"),a(),w(y.get("path")||"");break}case"loaded":{a();break}}});fetch("./conf.json").then(e=>e.json()).then(e=>{f=e,a()});})();
